\chapter{Methods}
\label{sec:methods}
\section{Purpose and goals}
In this thesis the goal is to examine the influence of uncertainty in models and parameters with regards to r-process nucleosynthesis.
This in turn, is used to estimate the influence of uncertainties with regards to the Rhenium-Osmium cosmic clock.
This will be done by comparing a semianalyical galactic chemical evolution model (\omegamodel) with data from a high resolution smoothed particle hydrodynamics simulations (\eris).

\omegamodel\ is used because of it's simplicity and versatility;
it can be executed as a python script on most computers, takes relatively little time to run and easily modifiable parameters.
\omegamodel\ also demonstrates a much larger resolution in mass, by dividing mass into a wide range of nuclei.

The smoothed particle hydrodynamics simulation \eris\ is a high resolution simulation that resembles the Milky Way Galaxy in many aspects, and is therefor a great candidate for a Milky Way Proxy.
Assuming that the evolution of \eris also resembles the evolution of the Milky Way allows us to use the star formation history and baryonic content data from \eris\ in order to match the generated data from \omegamodel.
Assuming that \eris\ is a good approximation to the Milky Way morphological history, the data from \eris\ are assumed to represent the mass and abundances of the Milky Way galaxy.
By finding a model of \omegamodel\ that most accurately reproduce the mean-values of \eris\footnote{Since \omegamodel\ is a one-zone model without spatial dimensions, it can only approximate the mean of \eris. Not the spatial resolution.}, a Milky Way-proxy (that resolves \re{187} and \os{187} isotopes is found.

After an appropriate parameter-space is estimated, the yields of some relevant nuclei (Eu-, Re-, Os-, W-isotopes available) can be varied within their observational uncertainties.
An semianalytical model, like \omegamodel, will merely calculate the total amount of ejecta from stars (yield tables) and integrate the ejecta in time.
Finding the effect of the observational uncertainties is done by changing the yields according to the observational uncertainties and tracking the difference through galactic time.

\section{Fitting \omegamodel\ to \eris-data}
% use \figwidth for width of figures
\setlength\figwidth{0.5\textwidth}
\newcommand\mwomega{\textit{\omegamodel-MilkyWay}}
\newcommand\mwcomega{\textit{\omegamodel-MilkyWay-c.sfr.}}
\newcommand\vanillaomega{\textit{Vanilla \omegamodel-model}}
\newcommand\fiduccialomega{\textit{Fiduccial \omegamodel-model}}

%\subsection{General purpose}
To fit the \omegamodel\ model to \eris, the star formation rate calculated for each timestep is used as the star formation history in \omegamodel.
This ensures that for sufficiently large timesteps \omegamodel\ will use the same star formation rate as \eris\ (however interpolated onto the timesteps used in \omegamodel).
Otherwise, the parameters of \omegamodel\ are examined, in order to best reproduce the total baryonic content of the simulation, as well as the spectroscopic abundance of [O/H], [Fe/H], and [Eu/H].

In this section \mwomega\ refers to the built-in options for a Milky Way-like model in \omegamodel, while \mwcomega\ is similar, but assumes a constant star formation rate. \fiduccialomega\ will be represent the parameter-space of \omegamodel that will reproduce data from \eris.

\subsection{Insertion\comment{(rename!)}}
\newcommand\insertion{insertion}
%method
Galactic age, initial mass function, astrophysical effects and star formation are so essential to chemical evolution models that they will be taken from \eris\ and applied directly to \omegamodel.
These values are listed in table \ref{tab:fitting-parameters-insertion}.

\textit{'Eris'} refers to data directly from \eris-simulation. \textit{'Omega' default} (or \vanillaomega) refers to the \omegamodel\ model with no change to the initial parameters (see description in section \ref{sec:omega}). \textit{'Omega' MW} (or \mwomega)refers to the \omegamodel\ model with the Milky Way parameter (see description in section \ref{sec:omega}), and \textit{'Omega' MW cte} (or \mwcomega) refers to the same but with a constant one-solar-mass-per-year star formation rate. \textit{'Omega' w/'Eris'-SFR} (or \fidducialomega) refers to the \omegamodel\ model with the star formation and mass function from \eris. This model, \fiduccialomega will be exaned upon throughout the fitting process.

It is clear from figures \ref{img:fit-v0-sfr} and \ref{img:fit-v0-stellarmass} that star-formation is suppressed before 2Gyr for all models except \vanillaomega.

%plots
\begin{figure}[h]
  \centering
  \includegraphics[width=\figwidth]{results/plots_fitting/set_sfr_plot_sfr.png}
  \caption[Star formation rate in \omegamodel\ for \insertion]{\label{img:fit-v0-sfr}
    Star formation rate(measured in solar masses of stars formed from gas each year) for four models of \omegamodel\ versus time. 
  }
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[width=\figwidth]{results/plots_fitting/set_sfr_plot_stellar_mass.png}
  \caption[Stellar mass in \omegamodel\ for \insertion]{\label{img:fit-v0-stellarmass}
    Total accumulated stellar mass(cumulutaive sum of stellar mass produces from gas, measured in solar masses) for four models of \omegamodel\ versus time.
  }
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[width=\figwidth, draft=true]{results/plots_fitting/set_sfr_plot_gas_mass.png}
  \caption[Gas mass in \omegamodel for \insertion]{\label{img:fit-v0-gasmass}
    \comment{Replot this image, looks sketchy! \\}
    Mass of gas in the interstellar medium for four different models of \omegamodel, and the \eris\ simulation against time in Gyrs.
  }
\end{figure}

\begin{table}[h]
  \centering
  \begin{tabular}{|c|c|l|}
    \hline Parameter & \omegamodel-argument & Value taken from \eris \\
    \hline Galactic age & \texttt{tend} & 14 Gyr \\
    Star formation rate & \texttt{sfh\_array} & Star-formation rate [$\msol/yr$]\footnote{Numerical array of time - star formation rate for each point in time in \eris.} \\
    Initial mass function & \texttt{imftype} & Kroupa93\footnote{because \mycite{shen15} uses the mass function from \mycite{kroupa93}} \\
    Type Ia supernovae & \texttt{sn1a\_on} & yes \\
    Binary neutron star mergers & \texttt{nsmerger\_on} & yes \\
    \begin{tabular}{c}
      Yield-table for \\
      binary neturon star mergers
    \end{tabular}
     & \texttt{ns\_merger\_table}& \mycite{arnould07} \\
    Neutron star - black hole merger & \texttt{bhns\_merger\_on} & no \\
    \hline
  \end{tabular}
  \caption[\omegamodel-parameters directly adopted from \eris]{ \label{tab:fitting-parameters-insertion}
    The yield-table for binary neutron star mergers was chosen because it was the only r-process yield-table (out of two available) with the presence of \re{187}.
    In \omegamodel, r-process yield tables are applied to neutron star mergers, and the yield-table chosen is calculated from the r-process abundance of the \sos at present day (\mycite{arnould07}).
    This means that all neutron star mergers are assumed to produce a r-process pattern like the one found in the \sos.
  }
\end{table}
\FloatBarrier

\subsection{Mass}
%method
\input{texfiles/mass_table_guedes}

A galaxy's mass consist of gas and stars (not counting dark matter from section \ref{sec:cosmology}), and in a one-zone model there is only gas and stars inside the box and gas outside the box (see figure \ref{tikz:galaxy_iobox}).
The total baryonic mass inside \eris\ (at redshift z=0 and z=1) is taken from \mycite{guedes11e} and can be found in table \ref{tab:guedes11-baryonic-mass}.

Supernova feedback will drive an outflow from the galaxy into the surrounding medium \comment{find appropriate reference}. Adding outflow proportional to the supernova rate adds some realisim to the model, and might reproduce some of the spectroscopic features.
In \omegamodel this is activated with the parameters \verb|mass_loading|(which ejects a amount of gas relative to the stellar mass formed), and \verb|out_follows_E_rate|(which adds a timedelay to the outflow, making the outflow proportional to the supernova rate instead of the star formation rate).
Outflow removes gas from the galaxy, or interstellar medium, lowering the total amount of mass in the galaxy. Therefore the initial primordial gas and constant inflow must be increased as well.
Setting the initial mass, inflow and outflow, gives the desired mass content.
A final comparison of the \fiduccialomega model, the predefined models (\mwomega, \mwcomega, and \omegamodel with all default parameters), and the data from the \eris\ simulation.
For the predefined models, the initial mass of primordial gas have been increased to $9.6\times10^{10}\msol$(the final value baryon-mass from \eris) to show the full evolution of star formation.
Two prominent features in the spectroscopic data of \eris\ is the two 'dips' around universal time t=5 and t=8 Gyrs. These dips might be reproduced by adding primordial inflow, hydrogen, and enriched outflow, concentrated on on those periods($t\simeq5Gyr$ and $t\simeq8Gyr$), since these periods might coincide with the death of stars from the star forming peak in figure \ref{img:fit-v0-sfr}.
Varying supernova-related outflow(known as the \texttt{mass\_loading} parameter) gives an expected result. In figure \ref{fig:fit-v1-2-iron} variation in the spectroscopic iron abundance can be seen the desired region, around the two 'dips', but the effect is too small to reproduce the two dips. The effect is also too wide and more closely similar to one big 'dip'. One unexpected result is that the smalles \texttt{mass\_loading} parameter yields the lowest dip(not really a dip at all, but more flat in the desired direction). suggesting that the outflow from supernovae occur later than the two 'dips'.
This means that the two 'dips' cannot be reproduced by outflow and inflow.

%plots
\begin{figure}[h]
  \centering
  \includegraphics[width=\figwidth]{results/plots_fitting/set_mass_1_plot_total_mass.png}
  \caption[]{\label{fig:fit-v1-1-total}
    The total baryonic mass of the \omegamodel-model for four different initial/inflow parameters.
    $M_0$ is the initial primordial gas of the galaxy(in \msol), $\dot{M}$ is the inflow (in \msol/yr).
    This visualization shows that 44G\msol and 3.7\msol/yr are the optimal parameters to reproduce the two baryonic data-points from \eris, although more then these four were tried.
  }
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[width=\figwidth]{results/plots_fitting/set_mass_1_plot_stellar_mass.png}
  \caption[]{\label{fig:fit-v1-1-stellar}
    Plotting the cumulative stellar mass formed in the inflow-\omegamodel-models. All four reproduce the \eris\ cumulative star formation, because these models have enough gas to form the stars.
  }
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[width=\figwidth]{results/plots_fitting/set_mass_2_plot_total_mass.png}
  \caption[]{\label{fig:fit-v1-2-total}
    Total baryonic mass of galaxy over time.\comment{what is the initial mass of gas and inflow rate?}
    The outflow adds a non-linear effect to the total mass.
  }
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[width=\figwidth]{results/plots_fitting/set_mass_2_plot_stellar_mass.png}
  \caption[]{\label{fig:fit-v1-2-stellar}
    Cumulative stellar mass formed against time for \comment{X} \omegamodel\ models, and the \eris-simulation.
    The outflow removes mass, but there is still enough gas to form stars from the \eris\ star formation rate.
  }
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[width=\figwidth]{results/plots_fitting/set_mass_2_plot_iron.png}
  \caption[]{\label{fig:fit-v1-2-iron}
    Iron abundance in the models with varying mass-loading parameters(solar masses of outflow per solar mass of supernova). The data from \eris\ show two 'dips' from the increasing tendency.
    The dips could not be reproduced by outflow of enriched material and inflow of hydrogen. Outflow peaks over the 'dips', reducing the spectroscopic abundance, however the effect is wide and smeared out over a time range beyond both 'dips'.
  }
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[width=\figwidth]{results/plots_fitting/set_mass_3_plot_total_mass.png}
  \caption[]{\label{fig:fit-v1-3-total}
    Total baryonic mass of galaxy over time for \eris, \fiduccialomega, \mwomega, \mwcomega\ and \omegamodel\ with all default parameters.
    Only the \fiduccialomega model reproduces the total mass content found in \eris, represent by two datapoints from table \ref{tab:guedes-baryonic-mass}.
  }
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[width=\figwidth]{results/plots_fitting/set_mass_3_plot_stellar_mass.png}
  \caption[]{\label{fig:fit-v1-3-stellar}
    Cumulative stellar mass formed over time for \eris, \mwomega, \mwcomega, \fiduccialomega\ and \omegamodel\ with all default parameters.
    All predefined models massively undershoots or overshoots the measured star formation in \eris.
    The \fiduccialomega\ model accurately reproduces the cumulative stellar formation with \eris. The slight variation between the \fiduccialomega\ model and \eris\ is due to low numerical resolution.
  }
\end{figure}
%% \begin{figure}[h]
%%   \centering
%%   \includegraphics[width=\figwidth]{results/plots_fitting/set_mass_3_plot_spectro_iron.png}
%%   \caption[]{\label{fig:fit-v1-3-iron}
%%     Spectroscopic iron over time for \eris, \mwomega, \mwcomega, \fiduccialomega\ and \omegamodel\ with all default parameters.
%%     The \fiduccialomega\ model has almost no star formation in the very beginning of the integration, this leads to a delayed chemical evolution that can be seen in the graph. The predefined models have some(if not much) star formation from the first integration step to the last. This implies that chemical evolution can begin much sooner, as can be seen in the graphs.
%%   }
%% \end{figure}
%% \begin{figure}[h]
%%   \centering
%%   \includegraphics[width=\figwidth]{results/plots_fitting/set_mass_3_plot_spectro_oxy.png}
%%   \caption[]{\label{fig:fit-v1-3-oxy}
%%     Spectroscopic oxygen over time for \eris, \mwomega, \mwcomega, \fiduccialomega and \omegamodel with all default parameters.
%%     The \fiduccialomega\ model has almost no star formation in the very beginning of the integration, this leads to a delayed chemical evolution that can be seen in the graph. The predefined models have some(if not much) star formation from the first integration step to the last. This implies that chemical evolution can begin much sooner, as can be seen in the graphs.
%%   }
%% \end{figure}
\FloatBarrier

\comment{Add iffalse here}
\iffalse

\subsection{Effect of stars and supernovae}
%specify AGB, massive, pop.3, SN1a
Chemical enrichment of galactic gas (the interstellar medium), comes from stars.
\comment{quick recap of theory section} Hydrogen and helium from the primordial gas is locked into a star, where fusion processes transmutates the elements into heavier elements up to iron. In the process some heavier elements are created, mostly by neutron capture processes. At the end of the stars life some of the material will be ejected back into the interstellar medium.
Asymptotic giant branch stars are low mass stars at the end of their life, they eject mass via episodes known as helium flashes, leaving a white dwarf behind.
Massive stars end their life as typeII supernovae, ejecting most of their enriched material leaving a neutron star or black hole behind.
The very first stars, with no initial chemical enrichment, or metallicity, are called population III stars. They are generally believed to have a slightly different initial mass distribution function, and could produce slightly different distributions of metals.
The exact science of population III stars is not well defined, as none has been observed, but the stellar population is one of the options of the \omegamodel\ model and should therefor be taken into consideration when comparing \eris and \omegamodel.
The remnants, white dwarves, neutron stars and black holes, are not the end of the story, binary star systems can bring new life to these dead bodies. A white dwarf accreting plasma from the envelope of a binary star can accumulate enough mass to ignite a core-collapse that ejects more enriched matter into the interstellar medium. Two neutron stars in orbit around eachother can loose gravitational energy to gravitational waves and merge. Such an energetic event will create alot of heavy elements and eject alot of the mass of the binary system with great velocity. Similar gravitational events can occur between two black holes and a black hole and a neutron star. The last two event will be ignored because two black holes do not create or eject any heavy elements (or any elements at all), while black hole neutron star merger is not included in \eris.

%methods
This section will look at the effect of yield-tables for massive stars and asymptotic giant branch stars, the transitionmass between medium mass stars and massive stars, the boundaries of the initial mass function of population III stars (the first metall-less stars) and their yield tables.
The values and tables available does not significantly alter the spectroscopic abundance of oxygen, iron, or europium, and the plots are therefor not shown here.
In order to look at the effect of type 1a supernvoae, the number of supernovae, their delay-time distribution are varied.
The yield-tables available for type 1a supernvoae give relatively similar results for oxygen and iron, so the plots are not shown here.

The delay-time distribution can be chosen from a gaussian, exponential or powerlaw distribution.
All were tried, but only the exponential distribution is shown in this section.

%plots
\begin{figure}[h]
  \centering
  %exp-sn1a [O/H]
  \includegraphics[scale=0.5]{results/plots_fitting/set_sn1a_plot_sn1a_dtd3_oxy.png}
  %exp-sn1a [Fe/H]
  \includegraphics[scale=0.5]{results/plots_fitting/set_sn1a_plot_sn1a_dtd3_iron.png}
  %num-sn1a [O/H]
  \includegraphics[scale=0.5]{results/plots_fitting/set_sn1a_plot_sn1a_num2_oxy.png}
  %num-sn1a [Fe/H]
  \includegraphics[scale=0.5]{results/plots_fitting/set_sn1a_plot_sn1a_num2_iron.png}
  \caption[Fit of type 1a supernovae \fiduccialomega]{\label{fig:fit-sn1a}
    Spectroscopic abundance of oxygen and iron in \omegamodel compared to the data from \eris.
  }
\end{figure}
\FloatBarrier

\subsection{Nucleosynthesis from r-process}
%specify BNSM
Only binary neutron star mergers are considered, because this is the same site as \mycite{shen15}
%methods
%plots
\comment{figure commented out}
%% \begin{figure}[h]
%%   \centering
%%   \includegraphics[scale=0.5]{results/plots_fitting/set_nsm_plot_dtd.png}
%%   \caption{\label{fig:fit-v3-dtd}
%%     Abundance of europium in \eris\ simulation and \omegamodel\ models for galactic time in Gyrs.
%%     There are two main ways to calculate the delay-time of a neutron star merger in \omegamodel: one is a powerlaw distribution in time(with boundaries at minimum and maximum time), while another is setting a time after which all neutron star binaries merge, called a coalescence time.
%%     \\ \comment{what does \eris\ use?} \\
%%     In order to reproduce the \eris\ spectroscopic abundances, \omegamodel\ must synthesize more europium at an earlier time, this is achieved by a steep distribution with early minimum-time. It is clear from the plot that all models behave similar at late times, regardless of delay-time distribution. There is also little difference between a short coalescence time or a powerlaw distribution with short minimum time.
%%   }
%% \end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{results/plots_fitting/set_nsm_plot_ejmass.png}
  \caption{\label{fig:fit-v3-ejecta}
    Spectroscopic europium abundance against galactic time for \eris-data and several \omegamodel models. In the models the mass ejected from each neutron star merger have been modified.
    Modifying the mass ejected from each event will just scale the total europium content up and down.
    Ejecting 0.2-0.3 \msol per event gives a pretty decent fit to late time europium and early time europium.
    However for the 'dips' between 2 and 8 Gyrs, the \omegamodel\ model overshoots the \eris\ data.
  }
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{results/plots_fitting/set_nsm_plot_mergerfraction_rates.png}
  \caption{\label{fig:fit-v3-mergerfrac-nsmr}}
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{results/plots_fitting/set_nsm_plot_mergerfraction_spectro.png}
  \caption{\label{fig:fit-v3-mergerfrac-euro}}
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{results/plots_fitting/set_nsm_plot_nbnsm_rates.png}
  \caption{\label{fig:fit-v3-number-nsmr}}
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{results/plots_fitting/set_nsm_plot_nbnsm_spectro.png}
  \caption{\label{fig:fit-v3-number-euro}}
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{results/plots_fitting/set_nsm_plot_combo_rates.png}
  \caption{\label{fig:fit-v3-combo-nsmr}}
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{results/plots_fitting/set_nsm_plot_combo_spectro.png}
  \caption{\label{fig:fit-v3-combo-euro}}
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{results/plots_fitting/set_nsm_plot_final_rates.png}
  \caption{\label{fig:fit-v3-nsmr}}
\end{figure}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{results/plots_fitting/set_nsm_plot_final_spectro.png}
  \caption{\label{fig:fit-v3-final-euro}}
\end{figure}
\FloatBarrier

\subsection{Size of timesteps}
%??
In the fitting process the timestep was chosen somewhat arbitrarily in order to give the best result in a realistic amount of time for working purposes. The size of the timesteps are important for accuracy of the result of a numerical calculation, longer and fewer timesteps give unaccurate results, but too short and too many timesteps take much memory and comupting time. numerical presicion and floating point arithmetic can also come into play at the shorter timestep simulations.

In order to check the accuracy of \omegamodel\ against \eris\ a comparison is needed.
\omegamodel\ uses two different timestepping tecnhiques, one with n logarithmic timesteps between start and end, and one with constant timesteps between start and end.
By varying the number of timesteps in the \omegamodel\ data for [O/H], [F/H], [Eu/H] in time will be created.
These data will be interpolated onto the time-data for \eris\ and compared to the \eris-data with a pearson chi-squared test. The pearson static is only used to compare the difference with increasing time-resolution, the chi-squared statistic will not be used to compare what is, in essence, two different simulations.

It should be noted that there were some peculiar difficulties discovered at this point. \omegamodel\ cannot create a stable list of timestep-values when the timesteps are shorter then the time-array in the input star formation rate (which, in this case belongs to \eris). The same problem also occured for some timestep-sizes close to the timestepsize of \eris.
This is the reason for the sparse datapoints at higher resolutions.

%plots
\setlength{\subfigwidth}{0.3\textwidth}
\begin{figure}
  \centering
  \begin{subfigure}{\subfigwidth}
    \includegraphics[width=0.5\textwidth]{results/resolution_analysis/resolution_difference_euro_logged.png}
    \caption{\label{fig:fit-res-euro}}
  \end{subfigure}
  \begin{subfigure}{\subfigwidth}
    \includegraphics[width=0.5\textwidth]{results/resolution_analysis/resolution_difference_euro_logged.png}
    \caption{\label{fig:fit-res-euro}}
  \end{subfigure}
  \begin{subfigure}{\subfigwidth}
    \includegraphics[width=0.5\textwidth]{results/resolution_analysis/resolution_difference_euro_logged.png}
    \caption{\label{fig:fit-res-euro}}
  \end{subfigure}
\end{figure}

\FloatBarrier

\subsection{Final parameters of \omegamodel}
\begin{table}[h]
  \centering
  \begin{tabular}{|c|c|c|}
    \hline \omegamodel-parameter & Description & Value \\
    \hline
  \end{tabular}
  \caption[Parameters for betsfit \omegamodel-model to \eris-data]{\label{tab:bestfit-parameters}
    \comment{TODO!}
    Parameters that produce best fit between \omegamodel and \eris-data.
  }
\end{table}
    
%table
\FloatBarrier

\section{Impact of stellar yields}
%method of manipulation
The \omegamodel\ model with \eris\ bestfit parameters is used to calculate the amount on \re{187}.
A single function of \omegamodel\ is overwritten in order to change the stellar yields of \re{187}.
The function multiplies the stellar yield of \re{187} ($Y_\re{187}$) with a constant, the new yield is denoted $\hat{Y}_\re{187}$.

The yield table for binary neutron star mergers is taken from \cite{arnould07} and is the calculated distribution of r-process isotopes in the \sos.
The \sos-distribution of isotopes is measured from the solar photosphere and chondrite meteorites in \cite{landolt93}.
The s-process distribution can be calculated from nuclear reaction networks, and the r-process/p-process distributions are calculated by subtracting the s-process distribution after fitting to the \sos-abundances.
The basic assumption is that all neutron star mergers eject material with the same isotopic distribution, and this distribution matches the observed solar distribution.
In short, the yield-table used is the \textit{observed} r-process distribution of the \sos, and this distribution is applied to every neutron star mergers.

In the \eris-postprocessing (\mycite{shen15}) the yield-table applied to all neutronstar mergers is a different one.
The yield table was based on simulations by \comment{(some reference to Rosswog)} of neutron star mergers. Those yield-tables however does not contain any output of \re{187}, which is essential for the purpose of this thesis.

\textit{What are the underlying uncertainties of the yield-tables that we so generously apply to our simulations?}
The yield-tables represent the distribution of isotopes and elements ejected from a star during the end of it's lifetime. This information comes from stellar evolution codes like \cite{paxton11} and the nuclear reaction networks applied to them, like \cite{pignatari16}.
Uncertainties in nuclear reaction rates, stellar interior environments and ejecta composition all add together to create a total uncertainty of yield tables which are hard to separate.
In this case, the neutron star mergers are \textit{assumed} to be the dominant contributer to r-process isotopes in the galaxy, and the distribution is \textit{assumed} to follow observed r-process distribution in our \sos (this is ultimately an assumption of homogeneity).
Following these assumptions, the uncertainties in nucleosynthesis of r-process isotopes will simply be the uncertainty \sos-observations\cite{arnould07}.
Simulations suggest\comment{(some reference to Rosswog)} that the ejecta yield of binary neutron star mergers are somewhat dependant on the electron-fraction of the initial neutron stars, not taking inhomogeneities, rotation, and magnetic field of the initial neutron stars into account. Also given the rarity of kilonovas (compact object mergers) the assumption of homogeneity is questionable.

\input{texfiles/modification_omega}

\begin{table}[h]
  \centering
  \input{texfiles/arnould_table_modified}
  \caption[Values and uncertainties of observed r-process abundances in the \sos]{\label{tab:arnould-rncp-uncertainty}
    Values and uncertainties of r-process nuclei near \re{187} from \mycite{arnould07}.
    The relative uncertainty, $\sigma$-values, are calculated on the assumption that min/max are the one-sigma standard deviations in either direction.
    These values are expanded upon in appendix \ref{sec:sos-nuclei}.
  }
\end{table}

%which yields tested, how?
The r-process yields (which applies to neutron star mergers in \omegamodel) are taken from \mycite{arnould07}.
These yields are the observed r-process abundances of the \sos, and the standing assumption is that the distribution of r-process nuclei from neutron star mergers follow the observed r-process abundances.
In this spirit, the yield-tables for neutron star mergers are modified with the uncertainty of observed r-process abundances in the \sos.
The values, absolute uncertainty and relative uncertainty of the selected nuclei are shown in table \ref{tab:arnould-rncp-uncertainty}.
The minimum and maximum values are interpreted as one-sigma deviations in either direction, and the relative uncertainty, $\sigma$ is calculated thereafter.

%which yields shown, why?
The effect of each nuclei in table \ref{tab:arnould-rncp-uncertainty} was calculated.
The results were very similar, so only \re{187} will be shown.
% plot + table Re-187
\setlength{\subfigwidth}{0.5\textwidth}
\begin{figure}[h]
  \begin{subfigure}{\subfigwidth}
    \centering
    \includegraphics[width=0.9\linewidth]{results/plots_yields/mdot_time_Re-187.png}
    \caption{Time evolution of \re{187} ejected from supernovae and neutron star mergers.}
  \end{subfigure}
  \begin{subfigure}{\subfigwidth}
    \centering
    \includegraphics[width=0.9\linewidth]{results/plots_yields/ism_time_Re-187.png}
    \caption{Time evolution of the total mass of \re{187} in the galaxy over time.}
  \end{subfigure}
  \begin{subfigure}{\subfigwidth}
    \centering
    \includegraphics[width=0.9\linewidth]{results/plots_yields/mdot_hist_Re-187.png}
    \caption{Sum total of mass of \re{187} ejected from supernovae and neutron star mergers.}
  \end{subfigure}
  \begin{subfigure}{\subfigwidth}
    \centering
    \includegraphics[width=0.9\linewidth]{results/plots_yields/ism_hist_Re-187.png}
    \caption{Sum total of mass of \re{187} in the interstellar medium of the galaxy}
  \end{subfigure}
  \caption[effect of nucelar uncertainties]{\label{fig:re187-yield-uncertainties}
    Resulting evolution of \re{187}-mass in a chemical evolution galaxy model.}
\end{figure}
%table of statistics input uncertainty vs. output uncertainty
\begin{table}
  \centering
  \input{results/data_yields/table_Re-187.dat}
  \caption[effect of nuclear uncertainties]{\label{tab:re187-yield-uncertainties}
    Comparison of output mass-uncertainty with input yield-uncertainty.
    $\sigma_{init}$ is the relative uncertainty from table \ref{tab:arnould-rncp-uncertainty} for zero, one, and two sigmas in either direction.
    $\sigma_{ISM}$ is the relative deviation between the resulting mass of the interstellar medium, at current time (Z=0) and integrated for all time ($\Sigma$).
    $\sigma_{\dot{m}}$ is the relative deviation between the ejected mass per timestep into the interstellar medium, at current time (Z=0) and integrated for all time ($\Sigma$).
  }
\end{table}
In table \ref{tab:re187-yield-uncertainties} the output deviation, in ejected mass and total mass, is compared to the input uncertainty.
The input uncertainty is the standard deviation from table \ref{tab:arnould-rncp-uncertainty} for one and two sigma deviation in either direction.
The table represent the deviation in figure \ref{fig:re187-yield-uncertainties}.
The relative uncertainty of the input is nearly the same as the output deviation.
This suggests that the uncertainty of the stellar yield-tables affect the total abundance linearly (the relative uncertainty remains the same throughout the calculation).
\FloatBarrier

\section{Uncertainty from multiple parameter}
%methods for main parameter-testing
For varying different parameters simultaneously a similar method was used as in section \ref{sec:results-yields}, where a ``fudge-factor'' was applied to the \eris\ best fitted parameter-values. The ``fudge-factor'' is distributed gaussian around 1.0 and the factor is the multiplied to the parameter-value.

%% The parameter values chosen are the ones that deal with r-process production; fraction of neutron stars that merge (number of mergers), the ejecta mass from a single neutron star merger, the delay-time distribution of merging events.
%% Also the relevant r-process isotopes \re{187}, \re{185}, \w{184}, \os{188}, and the relevant s-process isotopes \os{187}, \os{186}.
%% These are chosen because they lie close to the \re{187}-\os{187} pair in the chart of nuclides and also closely related to the s-process path (and branching path).

\subsubsection{Monte Carlo experiment}
%add code snippet and explain how omega was used after fitting
\input{texfiles/modification_omega2}
%explain data
\subsubsection{Postprocessing}
%explain beta decay on data -> create new data
%code snippet from beta-decay
\input{texfiles/postprocessing_betadecay}
%explain 'extraction' to new data-files and subsequent reduction to plots
\FloatBarrier

\section{Summary of methods}
\section{Discussion}

%\iffalse
%fitting of eris/omega

%variation of isotope-yield
Attempting to probe the uncertainties of nuclear observables is difficult, because both \eris\ and \omegamodel\ both use the observed r-process abundance from the \sos\ as the yield tables for all r-process events (\nsm\-s). This mean that all r-process events assume to generate the same distribution of heavy metals, and that distribution is the same as the component measured in the \sos.
In order to vary these values in \omegamodel\ a single isotope is chosen, along with a factor that applies to the yield of that isotope. When using \omegamodel, all yield tables will multiply with this factor for that specific isotope alone. E.g. ('C-14', 1.3) would mean that the yields for \isotope{C}{6}{14} will be multiplied with 1.3 in all yield tables.
This method does not only probe the nuclear uncertianties, varying the yield-tables of a chemical evolution code finds the effect of the accumulated uncertainty of the stellar evolution applied to chemical evolution methods.
\comment{add more details of stellar evolution codes in theory part I}

%variation of multiple parameters and montecarlo simulations
There are many parameters that affect r-process production alone. Ejecta distribution and size from \nsm and type II supernovae, and the ratio of ejecta and frequency between the two. Even in relatively simple galactic chemical evolution models, these parameters can interact in unpredictable ways. In order to get a complete picture of errors and uncertainty in numerical models, a common approach has been Monte Carlo style simulation\comment{do I need a reference for this?}. Each parameter is randomly drawn from a distribution correspondin g to their ``determined'' uncertainty (usually the chosen distributions are gaussian), and after many repetitions of randomly drawing, the result can be viewed statistically in order to determine uncertainty behavior.
This thesis will such an experiment with \comment{list parameters here} and see how the uncertainties of the r-process affect the uncertainty of the Re-Os dating method.

\section{fitting}
\input{results_fitting}
\section{impact of stellar yields}
\input{results_yields}

\fi
